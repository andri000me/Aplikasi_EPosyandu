<html>
<head>
	<title>Ibu</title>
	<script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
	<script>
		var nik;
		var nama;
		var email;
		var alamat;
		var datanya;
		$(document).ready(function(){
			//meloading option NIK dari database
			$("#nik").load("prosesCrudIbu.php", "op=ambiloption");

			//jika ada event onchange ambil data dari database
			$("#nik").change(function(){
				//ambil nilai nik dari form
				nik = $("#nik").val();
			
			//tampilkan status loading dan animasinya
			$("#status").html("Loading. . .");
			$("#loading").show();

			//lakukan pengiriman data 
			$.ajax({
				url: "prosesCrudIbu.php",
				data: "op=ambildata&nik="+nik,
				cache: false,
				success: function(msg){
					//karna di server pembatas setiap data adalah |
					//maka kita split dan akan membentuk array
					data = msg.split("|");

					//masukan ke masing - masing textfield
					$("#nama").val(data[0]);
					$("#email").val(data[1]);
					$("#alamat").val(data[2]);
					//hilangkan animasi loading
					$("#status").html("");
					$("#loading").hide();
				}
				});
			});
			//jika tombol update diclick
			$("#tupdate").click(function(){
				//ambil nilai-nilai dari masing-masing input
				nik = $("#nik").val();
				if (nik=="Pilih Nik") {
					alert("Pilih dulu NIK");
					exit();
				}
				nama = $("#nama").val();
				email = $("#email").val();
				alamat = $("#alamat").val();
				datanya = "&nik="+nik+"&nama="+nama+"&email="+email;
				datanya = datanya+"&alamat="+alamat;
				//tampilkan status Updating dan animasinya
				$("#status").html("Lagi di update. . .");
				$("#loading").show();
				$.ajax({
					url: "prosesCrudIbu.php",
					data: "op=update"+datanya,
					cache: false,
					success: function(msg){
						if (msg=="sukses") {
								$("#status").html("Update Berhasil . . ");
							}else{
								$("#status").html("ERROR. . .");
							}
							$("#loading").hide();
						}
				});
			});

			//jika tombol DEL diklik
			$("#tdelete").click(function(){
				nik = $("#nik").val();
				if (nik=="Pilih NIK") {
					alert("Pilih dulu NIK");
					exit();
				}
				$("#status").html("lagi didelete. . . ");
				$("#loading").show();
				$.ajax({
					url: "prosesCrudIbu.php",
					data: "op=delete&nik="+nik,
					cache: false,
					success: function(msg){
						if (msg=="sukses") {
							$("#status").html("Delete Berhasil. . . ");
						}else{
							$("#status").html("EROR. . .");
						}
						$("#nama").val("");
						$("#email").val("");
						$("#alamat").val("");
						$("#loading").hide();
						$("#nik").load ("prosesCrudIbu.php", "op=ambiloption");
					}
				});
			});

	//Jika link tambah dta diklik
	$("#formtambah").click(function(){ 
 		$("#formnik").show(); 
 		$("#nama_ibu2").val(""); 
 		$("#nik_ibu").val(""); 
 		$("#alamat_ibu").val(""); 
 		$("#no_telp_ibu").val(""); 
 		});
 	//jika link Tambah Data Karyawan diklik 
 $("#formtambah").click(function(){ 
 $("#formnik").show(); 
 $("#nama_ibu2").val(""); 
 $("#nik_ibu").val(""); 
 $("#alamat_ibu").val(""); 
 $("#no_telp_ibu").val(""); 
 }); 
 
 //jika tombol TAMBAH diklik 
 $("#ttambah").click(function(){ 
 //ambil nilai-nilai dari masing-masing input 
 nik = $("#nama_ibu2").val(); 
 if(nik==""){ 
 alert("Nama belum diisi\nKlik Tambah Data Ibu"); 
 exit(); 
 } 
 nik_ibu = $("#nik_ibu").val(); 
 alamat_ibu = $("#alamat_ibu").val(); 
 no_telp_ibu = $("#no_telp_ibu").val(); 
 datanya = "&nama_ibu="+nama+"&nik_ibu="+nik_ibu+"&alamat_ibu="+alamat_ibu; 
 datanya = datanya+"&no_telp_ibu="+no_telp_ibu; 
 			$("#status").html("Lagi ditambah..."); 
 			$("#loading").show(); 
 			$.ajax({ 
 			url: "prosesCrudIbu.php", 
 			data: "op=tambah"+datanya, 
 			cache: false, 
 			success: function(msg){ 
 			if(msg=="sukses"){ 
 			$("#status").html("Berhasil ditambah..."); 
 			}else{ 
			 $("#status").html("ERROR.."); } 
 			$("#loading").hide(); 
 			$("#nama_ibu").load("prosesCrudIbu.php","op=ambiloption"); 
 			$("#formnik").hide(); 
 			$("#nama_ibu2").val(""); }
 		});
 	});
});
 </script>
</head> 
<body> 
Nama Ibu : 
<select id="nama_ibu"></select> 
<br> 
<a id="formtambah" style="cursor:pointer;color:red;"><u>Tambah Data Karyawan</u></a> 
<p style="display:none" id="formnik"> 
Nama Ibu  :<br> 
<input type="text" id="nama_ibu2"> 
</p> 
<p> 
Nik ibu :<br> 
<input type="text" id="nik_ibu"><p> 
Alamat :<br> 
<input type="text" id="alamat_ibu"><p> 
No telp :<br> 
<input type="text" id="no_telp_ibu" size="30"><p> 
<button id="tupdate">UPDATE</button> 
<button id="tdelete">DEL</button> 
<button id="ttambah">TAMBAH</button> 
<br> 
<span id="status"></span> 
<img src="loading.gif" id="loading" style="display:none"> 
</body> 
</html>